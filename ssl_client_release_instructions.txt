;; $Id$

<verno> represents the new version number. At the time of this update, the
latest version was 2.17, so the new version number would be 2.18. Substitute
2.18 everywhere you see <verno>

Required:
  Unix/Linux/Mac:
    These machines should have everything you need by default, but make
    sure you have the following:
       gmake
       gcc 3.3 - especially on the Mac
       autoconf (v2.54 or greater)
  Windows:
    Visual C++ 6.0 (soon to be VC++ .net)
    InstallShield 5.5 Pro
    InstallShield Package for the Web v2

     boinc\win_build\installer\Media folder
      (copy from quarl or gmg build folders if you're starting a new
       build folder. This should be checked in once the required files
       are separated from the generated files)

Administrivia:
    Make a note in checkin_notes 

    Set the version number:
        do this on a unix machine, preferably in a clean checkout of boinc
            first, update the installer files for windows:
            [this is so these files actually get into the distribution source]
             % cd win_build/installer/Setup Files/Compressed Files/Language Independent/OS Independent
                <edit>  readme.txt  (change version number)
                <edit> license.txt  (change version number)
              [bonus: automate this process]

            % ./set-version <verno>
            (note: the make in your default path must be gnu make, or else
                   set-version will fail towards the end)
            % cvs ci -m 'new version'

    Make a source tarball and zip:
        % make dist  (if you have problems here, such as the make choking on
                      emacs save files, try "make -i dist")
        % cp boinc-<verno>.tar.gz boinc-<verno>.zip ~davea/boinc/doc/source/

Build
 Windows:
    Use the HP Kayak windows box (bart) in 329 or the Dell (skinner) in 325.

    bart: Open 'quarl' on the desktop.
    skinner: Open 'build' on the desktop.

    Open 'BOINC'

    Right click in the folder; select 'cvs update'
    resolve any M(erge) problems

    Open 'win_build'

    Open 'BOINC.dsw'

    in the visual c++ menu, pick
        Build->Clean
        Build->Rebuild All
          the exe will be in win_build\Build\Debug

    Open 'installer'

    open 'BOINC.ipr' (installshield project)

    in the installshield menu, pick
        Build->Media->Build Default Media
        [bonus: automate this process]
    
    open 'BOINC.pfw' (package for the web project)
       build everything, changing only the version numbers
       [note: there are nine screens to go through. the version
              numbers are on screen #1 and screen #9. Do not
              change anything else]
       [bonus: automate this process]

        The new windows installer (BOINC_<verno>_intelx86_windows.exe)
        will be left in this folder when you exit Package for the Web

    SFTP to boincadm@koloth:

    copy BOINC_<verno>_intelx86_windows.exe to the projects/AstroPulse_Beta/apps/boinc directory


 Linux/Solaris:
    use these hosts:
       Linux: milhouse
       solaris2.7: milkyway

    note 1: The solaris 2.7 build should be statically linked, and should support
            solaris 2.7-2.9

    do a clean check out; compile; copy to koloth:
        % cd ~
        % mkdir proj
        % cd proj
        % mkdir client-build-`<any boinc src dir>/boinc/config.guess`
        % cd client-build-`<any boinc src dir>/boinc/config.guess`
        % cvs co boinc
        % cd boinc
        % ./configure && make
        % scp client/boinc_<verno>_*.gz boincadm@koloth:projects/AstroPulse_Beta/apps/boinc/

    [bonus: automate this process]

 Mac OS X:
    use the G3 OS X 10.2 mac in 329 (setisf2):

    note:  The mac os x build is identical to the unix/linux builds, except that
           the configure step requires the --build argument to set a generic
           host type (see below). The mac os x client will run on either os x
           10.2 or 10.3 [10.1 or earlier is not supported])

    do a clean check out; compile; copy to koloth:
        % cd ~
        % mkdir proj
        % cd proj
        % mkdir client-build-powerpc-apple-darwin
        % cvs co boinc
        % cd boinc
        % ./configure --build=powerpc-apple-darwin
        % make
        % scp client/boinc_<verno>_*.gz boincadm@koloth:projects/AstroPulse_Beta/apps/boinc/

    Note: This same technique applies to building the setiathome application.
    [bonus: automate this process]

Test
 Test the installer(s) and start the new version on each test machine:
   Solaris 2.7 - milkyway
   Solaris 2.8 - kodos
   Solaris 2.9 - setisf1
   Linux - shaggy
   Mac OS X 10.2 - setisf2
   Mac OS X 10.3 - seti2
   WinXP - bart (329) or skinner (325)
   Win2K - kent (Aaron's desk)
   Win98 - marge [aka drake] (Matt's desk)

If all is well...

Update the server:
    ssh boincadm@koloth
    cd projects/Astropulse_Beta/bin
    ./update_versions &&
    ./stop
    ./start

